/*
 *  jQuery List Selection - v0.1.2
 *  File manager style rich selection for lists of elements
 *  https://github.com/tommarshall/jquery-list-selection
 *
 *  Made by Tom Marshall
 *  Under MIT License
 */
!function(a,b,c,d){function e(b,c){var d=this;d.el=b,d.$el=a(b),d.options=a.extend({},g,c),d._defaults=g,d._name=f,d.multiSelect=!1,d.rangeSelect=!1,d.$rangeRoot=null,d.$lastSelected=null,d.leftMouseDown=!1,d.init()}var f="listSelection",g={itemsSelector:"li",itemIDattribute:"uid",selectClass:"selected",contextSelectClass:"context-selected",clearContextSelectEvent:f+"-clearContextSelect",submitCallback:a.noop,deleteCallback:a.noop,contextCallback:a.noop};e.prototype={init:function(){var b=this;b.$items=b.$el.find(b.options.itemsSelector),b.$el.on("mousedown",b.options.itemsSelector,a.proxy(b._itemMouseDownHandler,b)),a(c).on("mouseup",a.proxy(b._mouseUpHander,b)),a(b.$el).on("mouseover",b.options.itemsSelector,a.proxy(b._itemMouseOverHandler,b)),a(c).on("keydown",a.proxy(b._keydownHander,b)),a(c).on("keyup",a.proxy(b._keyupHander,b)),""+b.options.contextCallback!=""+b._defaults.contextCallback&&(b.$el.on("contextmenu",a.proxy(b._contentMenuHander,b)),a(c).on(b.options.clearContextSelectEvent,a.proxy(b.clearContextSelect,b)))},clearContextSelect:function(){var a=this;a.$items.removeClass(a.options.contextSelectClass)},_itemMouseDownHandler:function(a){var b=this;2!==a.which&&3!==a.which&&b._leftClickHandler(a)},_mouseUpHander:function(){var a=this;a.leftMouseDown=!1,a._enableSelection()},_leftClickHandler:function(b){var c,d=this,e=a(b.target);return d._isSelected(e)&&d.multiSelect?(e.removeClass(d.options.selectClass),void 0):(d.multiSelect||d.rangeSelect||d._clearSelect(),d.rangeSelect?(c=d.$rangeRoot||d.$items.first(),d._clearSelect(),d._selectRange(c.index(),e.index()),d.$lastSelected=e):d._selectItem(e),d.rangeSelect||(d.$rangeRoot=e),d.leftMouseDown=!0,d._disableSelection(),void 0)},_contentMenuHander:function(b){var c=this,d=a(b.target),e=c._getSelected();return c._isSelected(d)?(e.addClass(c.options.contextSelectClass),c.options.contextCallback(c._getSelectedIDs())):(d.addClass(c.options.contextSelectClass),c.options.contextCallback([d.data(c.options.itemIDattribute)])),c._mouseUpHander(),!1},_itemMouseOverHandler:function(b){var c,d=this;d.leftMouseDown&&(c=a(b.target),d._clearSelect(),d._selectRange(d.$rangeRoot.index(),c.index()),d.$lastSelected=c)},_keydownHander:function(a){var b=this;switch(a.which){case 91:case 17:b.multiSelect=!0;break;case 16:b.rangeSelect=!0,b._disableSelection();break;case 27:b.$rangeRoot=null,b.$lastSelected=null,b._clearSelect();break;case 13:b.options.submitCallback(b._getSelectedIDs());break;case 46:case 8:b.options.deleteCallback(b._getSelectedIDs());break;case 38:b._navigateByKey("up");break;case 40:b._navigateByKey("down");break;case 65:b.multiSelect&&b._getSelected().size()&&b._selectAll();break;default:return}},_keyupHander:function(a){var b=this;switch(a.which){case 91:case 17:b.multiSelect=!1;break;case 16:b.rangeSelect=!1,b._enableSelection();break;default:return}},_isSelected:function(a){var b=this;return a.hasClass(b.options.selectClass)},_selectItem:function(a){var b=this;a.addClass(b.options.selectClass),b.$lastSelected=a},_selectRange:function(b,c){var d,e=this;b>c&&(d=b,b=c,c=d),e.$items.slice(b,c+1).each(function(){e._selectItem(a(this))})},_selectAll:function(){var b=this;b._disableSelection(a("body")),b.$items.each(function(){b._selectItem(a(this))}),setTimeout(function(){b._enableSelection(a("body"))},100)},_clearSelect:function(){var a=this;a.$items.removeClass(a.options.selectClass)},_getSelected:function(){var a=this;return a.$items.filter("."+a.options.selectClass)},_getSelectedIDs:function(){var b=this,c=[];return b._getSelected().each(function(){c.push(a(this).data(b.options.itemIDattribute))}),c},_navigateByKey:function(a){var b,c=this;c.multiSelect||c.$lastSelected&&("up"===a?b=c.$lastSelected.prev():"down"===a&&(b=c.$lastSelected.next()),b&&b.size()&&(c.rangeSelect?(c._clearSelect(),c._selectRange(c.$rangeRoot.index(),b.index()),c.$lastSelected=b):(c._clearSelect(),c._selectItem(b),c.$rangeRoot=b)))},_disableSelection:function(a){var b=this;a===d&&(a=b.$el),a.attr("unselectable","on").css({"-moz-user-select":"none","-o-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"}).on("selectstart",function(){return!1})},_enableSelection:function(a){var b=this;a===d&&(a=b.$el),a.removeAttr("unselectable").css({"-moz-user-select":"","-o-user-select":"","-khtml-user-select":"","-webkit-user-select":"","-ms-user-select":"","user-select":""}).off("selectstart",function(){return!1})}},a.fn[f]=function(b){var c,g=arguments;return b===d||"object"==typeof b?this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))}):"string"==typeof b&&"_"!==b[0]&&"init"!==b?(this.each(function(){var d=a.data(this,"plugin_"+f);d instanceof e&&"function"==typeof d[b]&&(c=d[b].apply(d,Array.prototype.slice.call(g,1))),"destroy"===b&&a.data(this,"plugin_"+f,null)}),c!==d?c:this):void 0}}(jQuery,window,document);